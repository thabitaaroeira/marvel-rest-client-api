<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<h:body>

	<h1>Personagens</h1>

	<f:metadata>
		<f:viewParam name="characterId" value="#{characterBean.characterId}" />
		<f:viewAction action="#{characterBean.carregarPersonagemPorId}"
			if="#{param.characterId != null}" />
	</f:metadata>

	<h:form id="formCharacter">
		<fieldset>
			<legend>Dados do Personagem</legend>

			<h:panelGrid columns="3">

				<h:outputLabel value="Nome:" for="nome" />
				<h:inputText id="nome" value="#{characterBean.character.name}"
					required="true">
					<f:validateLength minimum="5" />
					<f:ajax event="blur" render="messageNome" />
				</h:inputText>
				<h:message for="nome" id="messageNome" />

				<h:outputLabel value="Email:" for="email" />
				<h:inputText id="email" value="#{characterBean.autor.email}"
					required="true">
					<f:passThroughAttribute name="type" value="email" />
				</h:inputText>
				<h:message for="email" id="messageEmail" />

				<h:commandButton value="Gravar" action="#{characterBean.gravar}" />

			</h:panelGrid>
		</fieldset>
	</h:form>

	<h:form id="formPesquisa">
		<fieldset>
			<legend>Pesquisar Personagem</legend>

			<h:panelGrid>
				<h:outputLabel value="Nome: " for="pesquisa" />
				<h:inputText id="pesquisa"
					value="#{characterBean.filtro.name}" />
				<h:commandButton value="Pesquisar"
					action="#{characterBean.pesquisar}" />
			</h:panelGrid>

		</fieldset>
	</h:form>

	<h:form id="formTabelaCharacters">
		<h:dataTable value="#{characterBean.characters}" var="character"
			id="tabelaCharacters">
			<h:column>
				<f:facet name="header">Nome</f:facet>
				<h:outputText value="#{character.name}" />
			</h:column>
			<h:column>
				<f:facet name="header">Alterar</f:facet>
				<h:commandLink value="altera"
					action="#{characterBean.carregar(character)}" />
			</h:column>
			<h:column>
				<f:facet name="header">Remover</f:facet>
				<h:commandLink value="remove"
					action="#{characterBean.remover(character)}" />
			</h:column>
		</h:dataTable>
	</h:form>

</h:body>

</html>